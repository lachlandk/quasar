self.Quasar=new function(){this.gcd=function(e,t){let a=Math.max(Math.abs(e),Math.abs(t)),s=Math.min(Math.abs(e),Math.abs(t));for(;0!==s;){let e=a%s;a=s,s=e}return a},this.bezout=function(e,t){let a=Math.max(Math.abs(e),Math.abs(t)),s=Math.min(Math.abs(e),Math.abs(t)),i=1,p=0,n=0,h=1;for(;0!==s;){let e=Math.floor(a/s),t=a-e*s,o=i-e*p,l=n-e*h;a=s,i=p,n=h,s=t,p=o,h=l}return[n,i]},this.lcm=function(e,t){return Math.abs(e*t)/this.gcd(e,t)},this.parse=function(e){const t=e.match(/\d+|sin|cos|tan|log|ln|root|sqrt|cbrt|{(?:alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|pi|rho|sigma|tau|upsilon|phi|chi|psi|omega|altsigma|varphi)}|\S/gi);let a=[];t.forEach(function(e,s){if(e.match(/sin|cos|tan|log|ln|root|sqrt|cbrt/))e.match(/sin|cos|tan/)&&t[s+1]+t[s+2]+t[s+3]==="^-1"?(a.push({type:"function",value:"arc"+e}),t.splice(s+3,1),t.splice(s+2,1),t.splice(s+1,1)):a.push({type:"function",value:e});else if(e.match(/Alpha|Beta|Gamma|Delta|Epsilon|Zeta|Eta|Theta|Iota|Kappa|Lambda|Mu|Nu|Xi|Omicron|Rho|Tau|Upsilon|Phi|Chi|Psi|Omega/))a.push({type:"variable",value:e.slice(1,e.length-1)});else if(e.match(/alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|xi|omicron|rho|sigma|tau|upsilon|phi|chi|psi|omega|altsigma|[Vv]arphi|Sigma/))a.push({type:"variable",value:e.toLowerCase().slice(1,e.length-1)});else if(e.match(/[Pp]i|[ei]/))a.push({type:"constant",value:e.match(/[Pp]i|[ei]/g)[0].toLowerCase()});else if(e.match(/\d+/))a.push({type:"constant",value:parseInt(e)});else if(e.match(/[a-z]/i))a.push({type:"variable",value:e});else if(e.match(/[+\-*/^]/))e.match(/\^/)?a.push({type:"operator",value:"^",associativity:"right",precedence:1}):e.match(/[\/*]/)?a.push({type:"operator",value:e,associativity:"left",precedence:2}):e.match(/[+-]/)&&a.push({type:"operator",value:e,associativity:"left",precedence:3});else if(e.match(/[(\[]/))a.push({type:"open-parenthesis",value:e});else if(e.match(/[)\]]/))a.push({type:"close-parenthesis",value:e});else{if(!e.match(/,/))throw{name:"LexingError",msg:"Unknown Token"+e};a.push({type:"delimiter",value:e})}});for(let e=0;e<a.length;e++)"function"!==a[e].type||"open-parenthesis"===a[e+1].type||"variable"!==a[e+1].type&&"constant"!==a[e+1].type||(a.splice(e+1,0,{type:"open-parenthesis",value:"("}),a.splice(e+3,0,{type:"close-parenthesis",value:")"})),0===e||"variable"!==a[e].type&&"constant"!==a[e].type&&"open-parenthesis"!==a[e].type&&"function"!==a[e].type?"operator"===a[e].type&&(!a[e].value.match(/[+-]/)||0!==e&&"operator"!==a[e-1].type&&"open-parenthesis"!==a[e-1].type&&"delimiter"!==a[e-1].type||("-"===a[e].value?a[e]={type:"operator",value:"~",precedence:0}:a.splice(e,1))):"variable"!==a[e-1].type&&"constant"!==a[e-1].type&&"close-parenthesis"!==a[e-1].type||a.splice(e,0,{type:"operator",value:"*",associativity:"left",precedence:2});let s=[],i=[];for(;0!==a.length;){let e=a.shift();if("constant"===e.type||"variable"===e.type)s.push(e);else if("function"===e.type||"open-parenthesis"===e.type)i.unshift(e);else if("delimiter"===e.type||"close-parenthesis"===e.type){for(;"open-parenthesis"!==i[0].type;)s.push(i.shift());"close-parenthesis"===e.type&&(i.shift(),0!==i.length&&"function"===i[0].type&&s.push(i.shift()))}else if("operator"===e.type)if("left"===e.associativity){for(;0!==i.length&&"operator"===i[0].type&&i[0].precedence<=e.precedence;)s.push(i.shift());i.unshift(e)}else if("right"===e.associativity){for(;0!==i.length&&i[0].precedence<e.precedence;)s.push(i.shift());i.unshift(e)}else i.unshift(e)}for(;0!==i.length;)s.push(i.shift());return s}};